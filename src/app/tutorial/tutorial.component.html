<div class="progress success">
	<progress max="2" [value]="step"></progress>
</div>

<button class="btn btn-primary" (click)="indietro($event)" [disabled]="step == 0">Fase precedente</button>
<button class="btn btn-success" (click)="avanti($event)" [disabled]="step == 2">Fase successiva</button>

<div *ngIf="step==0">
	<h1>Osservazioni</h1>

	<p>Vi prego di non badare troppo alla forma grafica: ci penseremo a tempo debito (ossia, so che non è granché).
	</p>
	<p>
	Per ora l'esercizio è unico: penseremo poi a come formare gli esercizi.
	</p>
</div>


<div *ngIf="step==1">
	<h1>Esempio</h1>
	<p>Questo è l'esempio da cui si parte.</p>
	<p>Notare che nell'angolo in alto a destra, nelle impostazioni, è possibile decidere se visualizzare tutti i passaggi o soltanto l'ultimo. Potrebbe
	essere utile, per esempio, in base alle dimensioni del dispositivo o in base a qualche altra condizione che magari ci verrà in mente.</p>

	<div class="clr-row" >
		<div class="clr-col-2 clr-col-sm-2 clr-col-md-2 clr-col-lg-1 clr-col-xl-3">
		<div>
			<div class="card">
			<div class="card-block"><p class="card-text">12</p></div>
			</div>
			</div>
		</div>


		<div class="clr-col-2 clr-col-sm-2 clr-col-md-2 clr-col-lg-1 clr-col-xl-3">
		<div id="B2">
			<div class="card">
			<div class="card-block"><p class="card-text">+</p></div>
			</div>
		</div>
		</div>

		<div class="clr-col-2 clr-col-sm-2 clr-col-md-2 clr-col-lg-1 clr-col-xl-3">
		<div>
			<div class="card">
			<div class="card-block"><p class="card-text">17</p></div>
			</div>
		</div>
		</div>
	</div>
</div>


<div *ngIf="step==2">
	<h1>Le proprietà dissociativa e associativa</h1>
	
	<clr-alert [clrAlertType]="'warning'" *ngIf="passaggi.length > 1">
		<clr-alert-item>
			<span class="alert-text">
				Continuare a decomporrre i numeri toccandoli o cliccandoli oppure sommarli trascinandoli, dalla mano, uno sull'altro.
			</span>
		</clr-alert-item>
	</clr-alert>

	<p *ngIf="passaggi.length == 1">Cliccare o toccare su di uno dei numeri.</p>
	<div *ngFor="let riga of passaggi; index as numeroRiga; last as ultimo">
		<div class="clr-row" cdkDropList cdkDropListOrientation="horizontal" (cdkDropListDropped)="drop($event)">
			<div class="clr-col-1 clr-col-sm-1 clr-col-md-1 clr-col-lg-1 clr-col-xl-1"
				*ngFor="let carattere of riga; index as j;">
					<div *ngIf="visualizzaPassaggi? true : ultimo" class="card"
						[ngClass]="{clickable: ultimo && cliccabile(carattere)}"
						cdkDrag
						[cdkDragDisabled]="!(ultimo && cliccabile(carattere) && numeroRiga!=0)">
						<div class="card-header" cdkDragHandle *ngIf="ultimo && cliccabile(carattere) && numeroRiga!=0"><clr-icon shape="cursor-hand-grab"></clr-icon></div>
						<div class="card-block"
						(click)="modaleScomposizione=ultimo&&cliccabile(carattere);
						numeroScomposto = carattere; indiceNumeroScomposto = j"><p class="card-text">{{carattere}}</p></div>
					</div>
					<div class="card customPlaceholder" *cdkDragPlaceholder></div>
			</div>
			<!--Questo div serve per far riconosce la fine della riga dei passaggi (altrimento se si fa drop dopo l'ultima card viene sempre chiesto di sommare con l'ultimo valore-->
			<div class="clr-col-1 clr-col-sm-1 clr-col-md-1 clr-col-lg-1 clr-col-xl-1" cdkDrag></div>
			
			
			
			<div class="clr-col-1 clr-col-sm-1 clr-col-md-1 clr-col-lg-1 clr-col-xl-1">
				<div class="card card-block risultatoCorretto" *ngIf="!isArray(riga)"><p class="card-text">{{riga}}</p>
				</div>
			</div>
		</div>
		
	</div>
	
	
	<clr-modal [(clrModalOpen)]="modaleScomposizione">
		<h3 class="modal-title">Proprietà dissociativa</h3>
		
		<div class="modal-body">
			<p>Qui si potrà poi scrivere a mano, ma per ora utiliziamo la tastiera</p>
			<app-input-scomposizione
				[numeroScomposto] = 'numeroScomposto'
				[indiceNumeroScomposto] = 'indiceNumeroScomposto'
				[(passaggi)] = 'passaggi'
				[(modaleScomposizione)] = 'modaleScomposizione'></app-input-scomposizione>
		</div>
		<div class="modal-footer">
			<button type="button" class="btn btn-outline" (click)="modaleScomposizione = false">Annulla</button>
			<button type="button" class="btn btn-primary" (click)="controlloDecomposizione()">Ok</button>
		</div>
	</clr-modal>
	
	<clr-modal [(clrModalOpen)]="modaleAssociativa">
		<h3 class="modal-title">Proprietà associativa</h3>
		
		<div class="modal-body">
			<p>Qui si potrà poi scrivere a mano, ma per ora utiliziamo la tastiera</p>
			<app-input-somma-algebrica
				[valoreSovrapposto] = 'valoreSovrapposto'
				[valoreSpostato] = 'valoreSpostato'
				[eventoDrop] = 'eventoDrop'
				[(passaggi)] = 'passaggi'
				[(modaleAssociativa)] = 'modaleAssociativa'></app-input-somma-algebrica>
		</div>
		<div class="modal-footer">
			<button type="button" class="btn btn-outline" (click)="modaleAssociativa = false">Annulla</button>
			<button type="button" class="btn btn-primary" (click)="controlloAssociativa()">Ok</button>
		</div>
	</clr-modal>
</div>
